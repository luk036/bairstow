============================= test session starts ==============================
platform linux -- Python 3.10.4, pytest-6.2.5, py-1.10.0, pluggy-0.13.0 -- /usr/bin/python3
cachedir: .pytest_cache
benchmark: 3.4.1 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
hypothesis profile 'default' -> database=DirectoryBasedExampleDatabase('/home/lubuntu/Documents/github/py/bairstow/.hypothesis/examples')
rootdir: /home/lubuntu/Documents/github/py/bairstow, configfile: setup.cfg
plugins: benchmark-3.4.1, hypothesis-6.53.0, cov-3.0.0, anyio-3.5.0, xdist-2.5.0, forked-1.4.0, sugar-0.9.4
collecting ... collected 4 items

tests/test_aberth.py::test_aberth1 PASSED                                [ 25%]
tests/test_aberth.py::test_aberth2 PASSED                                [ 50%]
tests/test_aberth.py::test_aberth_fir PASSED                             [ 75%]
tests/test_aberth.py::test_aberth_autocorr_fir FAILED                    [100%]

=================================== FAILURES ===================================
___________________________ test_aberth_autocorr_fir ___________________________

    def test_aberth_autocorr_fir():
        z0s = initial_aberth_autocorr(r)
        opt = Options()
        opt.tol = 1e-14
        zs, niter, found = aberth_autocorr(r, z0s, opt)
        print([niter, found])
        for z in zs:
            print(z)
>       assert niter <= 1
E       assert 9 <= 1

tests/test_aberth.py:99: AssertionError
----------------------------- Captured stdout call -----------------------------
[9, True]
(-0.01708570955536787+0.9946321560559841j)
(-0.01708570955536994-0.9946321560559815j)
(0.663434703103994+0.7478522728812603j)
(-0.7097095112984959-0.7004686431862278j)
(-0.7097095112984964+0.7004686431862259j)
(0.6634347031039589-0.7478522728812618j)
(0.6132419007802659-1.2924697071141057e-26j)
(-0.9556588041664913-0.2541062514465818j)
(-0.5045265391304659+0.8555653611715519j)
(0.46739037176873627-0.8787634442582827j)
(0.23504567189463849+0.9674235985709538j)
(-0.2683108891496208-0.953747999786342j)
(-0.9556588041664901+0.25410625144657983j)
(0.816671983878264-0.14206084732329277j)
(0.816671983878264+0.14206084732329277j)
(-0.9868810470197693-1.05983557569184e-15j)
(-0.2683108891496214+0.953747999786342j)
(0.23504567189463157-0.96742359857095j)
(0.4673903717687339+0.8787634442582866j)
(-0.5045265391304642-0.8555653611715502j)
(-0.8642977450547945+0.4939931929963118j)
(0.7883908793564072-0.6139231834554831j)
(0.7883908793564002+0.6139231834554242j)
(-0.864297745054794-0.4939931929963113j)

---------- coverage: platform linux, python 3.10.4-final-0 -----------
Name                          Stmts   Miss Branch BrPart  Cover   Missing
-------------------------------------------------------------------------
src/bairstow/__init__.py          6      0      0      0   100%
src/bairstow/aberth.py           88      8     38      4    89%   75-78, 147, 169, 228, 231
src/bairstow/autocorr.py         96     96     48      0     0%   1-185
src/bairstow/lds.py              77     29     10      0    67%   108-109, 117, 126-127, 159, 167-168, 177, 209-210, 218-221, 230-231, 265-267, 275-280, 293-295
src/bairstow/matrix2.py          10      5      2      0    58%   12, 23, 31-33
src/bairstow/rootfinding.py      71     56     22      0    18%   37-40, 62-64, 84-89, 107-122, 144-164, 183-191
src/bairstow/skeleton.py         32     32      2      0     0%   23-135
src/bairstow/vector2.py          39     22      2      0    46%   11-12, 21, 30, 41, 52-54, 65, 76-78, 89, 100-102, 113, 124-126, 137, 145
-------------------------------------------------------------------------
TOTAL                           419    248    124      4    40%

=========================== short test summary info ============================
FAILED tests/test_aberth.py::test_aberth_autocorr_fir - assert 9 <= 1
========================= 1 failed, 3 passed in 0.50s ==========================
